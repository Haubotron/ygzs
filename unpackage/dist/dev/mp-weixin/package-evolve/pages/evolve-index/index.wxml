<view class="tech-tree-container"><view class="header"><view class="back-button" bindtap="{{a}}"><view class="back-icon"></view></view><view class="title">{{b}}</view><view class="close-button" bindtap="{{c}}">×</view></view><view class="tree-selector"><scroll-view scroll-x class="tree-selector-scroll" show-scrollbar="false"><view class="tree-options-container"><view wx:for="{{d}}" wx:for-item="tree" wx:key="b" class="{{['tree-option', tree.c && 'active']}}" bindtap="{{tree.d}}">{{tree.a}}</view></view></scroll-view></view><view class="resource-controls"><view class="resource-display"><image class="resource-icon" src="{{e}}"></image><input class="resource-input" type="number" value="{{f}}" bindinput="{{g}}"/></view><view class="control-buttons"><button class="{{['control-button', i && 'active-mode']}}" bindtap="{{j}}">{{h}}</button><button wx:if="{{k}}" class="control-button save-button" bindtap="{{l}}"> 保存设置 </button><button class="control-button reset-button" bindtap="{{m}}"> 重置 </button></view></view><view wx:if="{{n}}" class="edit-mode-tip"> 编辑模式：设置初始技能等级不消耗资源，点击保存后生效 </view><scroll-view scroll-y class="tech-tree-content"><view wx:for="{{o}}" wx:for-item="level" wx:key="f" class="level-container"><view class="level-label">层级 {{level.a}}</view><view class="{{['skills-row', level.d && 'center-skill']}}"><block wx:for="{{level.b}}" wx:for-item="skill" wx:key="y"><view class="{{['skill-item', skill.r && 'skill-maxed', skill.s && 'skill-unlocked', skill.t && 'skill-locked', skill.v && 'skill-left', skill.w && 'skill-right', level.c && 'skill-center']}}" bindtap="{{skill.x}}"><view class="skill-icon-container"><image class="skill-icon" src="{{p}}"></image><view wx:if="{{skill.a}}" class="max-badge">MAX</view></view><view class="skill-name">{{skill.b}}</view><view class="skill-level">{{skill.c}}/{{skill.d}}</view><view class="skill-controls"><button class="btn-decrease" catchtap="{{skill.e}}" disabled="{{skill.f}}">-</button><button class="btn-increase" catchtap="{{skill.g}}" disabled="{{skill.h}}">+</button><button class="btn-max" catchtap="{{skill.i}}" disabled="{{skill.j}}">MAX</button></view><view wx:if="{{skill.k}}" class="skill-dependencies"><view wx:for="{{skill.l}}" wx:for-item="dep" wx:key="d" class="dependency-item"><text>需要: {{dep.a}} ({{dep.b}}/{{dep.c}})</text></view></view><view class="skill-cost"><view wx:if="{{skill.m}}"> 下一级: {{skill.n}} 鱼骨头 </view><view wx:else>已达最大等级</view></view><view wx:if="{{skill.o}}" class="unlock-next-level"> 解锁下一层需要: {{skill.p}}/{{skill.q}}</view></view></block></view><view wx:if="{{level.e}}" class="connection-line"></view></view><view class="action-buttons"><button class="action-button calculate-button" bindtap="{{r}}"><image class="button-icon" src="{{q}}"></image><text>计算所需鱼骨头</text></button><button class="action-button progress-button" bindtap="{{t}}"><image class="button-icon" src="{{s}}"></image><text>查看可升级进度</text></button></view><view wx:if="{{v}}" class="resource-result"><view class="result-title">未点亮科技所需资源</view><view class="result-content"><view class="resource-item"><image class="resource-icon" src="{{w}}"></image><view class="resource-value">{{x}} 鱼骨头</view></view></view><view wx:if="{{y}}" class="remaining-resources"> 还差 {{z}} 鱼骨头才能点亮所有科技 </view><view wx:elif="{{A}}" class="remaining-resources positive"> 当前资源充足，剩余 {{B}} 鱼骨头 </view></view><view wx:if="{{C}}" class="resource-result"><view class="result-title">当前资源可升级进度</view><view class="progress-content"><view wx:for="{{D}}" wx:for-item="skill" wx:key="d" class="progress-item"><view class="progress-skill-name">{{skill.a}}</view><view class="progress-detail"> 可从 {{skill.b}} 级升至 {{skill.c}} 级 </view></view></view><view wx:if="{{E}}" class="no-progress"> 当前资源不足以升级任何科技 </view></view></scroll-view></view>